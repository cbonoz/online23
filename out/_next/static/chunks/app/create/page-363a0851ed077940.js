(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[572],{31119:function(e,t,r){Promise.resolve().then(r.bind(r,75711))},75711:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return L}});var n=r(57437),a=r(2265),i=r(88110),s=r.n(i),l=r(43574),o=r(20020),c=r(18142),d=r(13405),h=r(95708),u=r(40155),x=r(16681),p=r(28170),g=r(52955),f=r(61927),j=r(86568);async function b(e,t){let r=[...e];if(t){let e=new Blob([JSON.stringify(t)],{type:"application/json"}),n=new File([e],"metadata.json");r.push(n)}let n=new j.xk({token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJkaWQ6ZXRocjoweDlmODY5YjQyNzgzQTNmMUE1MkIxMUU4MTNmYTkyMTI1MUE4MTgxOUIiLCJpc3MiOiJ3ZWIzLXN0b3JhZ2UiLCJpYXQiOjE2OTQ5ODc3OTM4MTYsIm5hbWUiOiJtYWNtaW5pIn0.UnlzMyjqE6MV6cRrGMBWxP5kkkuRBamWWn5dWfs3fl8"}),a=await n.put(r);return console.log("stored files with cid:",a),a}var m=r(44840),v=r(86260),y=r(22440),w=r(16691),k=r.n(w);let C={display:"flex",flexDirection:"row",flexWrap:"wrap",marginTop:16},D={display:"inline-flex",borderRadius:2,border:"2px dotted gray",marginBottom:8,marginRight:8,width:200,textAlign:"left",height:75,overflow:"hidden",padding:4,boxSizing:"border-box"},N={display:"flex",minWidth:0,overflow:"hidden"};function M(e){let{files:t,setFiles:r}=e,{getRootProps:i,getInputProps:s}=(0,y.uI)({onDrop:e=>{console.log("files",e);let t=!0;e.forEach(e=>{e.size>1e7&&(alert("File ".concat(e.name," must be under 10MB for demo")),t=!1)}),t&&r(e.map(e=>Object.assign(e,{preview:URL.createObjectURL(e)})))}}),l=t.map(e=>(0,n.jsxs)("div",{style:D,children:[(0,n.jsxs)("span",{children:[(0,n.jsx)(k(),{alt:"File preview",src:"https://cdn-icons-png.flaticon.com/512/299/299378.png",width:32,height:32}),"\xa0"]}),(0,n.jsx)("div",{style:N,children:(0,n.jsxs)("p",{children:[(0,n.jsx)("b",{children:e.name}),(0,n.jsx)("br",{}),e.size&&(0,n.jsxs)("span",{children:["Size: ",(0,f.RD)(e.size),(0,n.jsx)("br",{})]}),e.type&&(0,n.jsxs)("span",{children:["Type: ",e.type]})]})})]},e.name));return(0,a.useEffect)(()=>()=>{t.forEach(e=>URL.revokeObjectURL(e.preview))},[t]),(0,n.jsxs)("section",{children:[(0,n.jsxs)("div",{...i({className:"dropzone"}),children:[(0,n.jsx)("input",{...s()}),(0,n.jsx)("p",{children:"Drag 'n' drop some files here, or click to select files"})]}),(0,n.jsx)("br",{}),(0,n.jsx)("b",{children:0===t.length?"No files uploaded":"Files to upload:"}),(0,n.jsx)("aside",{style:C,children:l})]})}var I=r(23199),U=r(73760),Z=r(66978),O=r(67245);let{Step:W}=d.default;function S(){let{connect:e,provider:t,wallet:r,logout:i}=(0,O.useWallet)(),[j,y]=(0,a.useState)({}),[w,k]=(0,a.useState)(),[C,D]=(0,a.useState)(!1),[N,W]=(0,a.useState)(),S=()=>y({...(0,v.jn)(1)}),L=(e,t)=>{y({...j,[e]:t})},T=j.name&&j.description&&j.price?!j.useCid&&(0,f.xb)(j.files)?"Must add at least one file":j.useCid&&(0,f.xb)(j.cid)?"Must provide a CID for the dataset":void 0:"Please provide a name, description, price for the item.",_=async()=>{if(k(void 0),T){k(T);return}if(!t){k("Please connect a valid ".concat(v.hs.name," wallet"));return}D(!0);let e={...j};(0,f.xb)(e.keywords)||(e.description="".concat(e.description,"} | {").concat(e.keywords,"}}"));let r=(e.files||[]).map(e=>e),n={...j};try{let e,a=j.cid;if(!j.useCid){if((0,f.xb)(j.files))throw Error("No files found");a=await b(r,n)}let i=U.fi(n.price.toString()).toString();e=await (0,Z.PT)(t.signer,a,i),n.cid=a,n.contract=e.address,n.listingUrl=(0,f.sN)(e.address||a),n.contractUrl=(0,f.jY)(e.address);let s={...j};s.address=e.address;try{(0,I.X8)(t.signer,s)}catch(e){console.error("error creating db listing",e)}W(n)}catch(t){var a;console.error("error creating distributed crypto request",t);let e=t.reason||(null===(a=t.response)||void 0===a?void 0:a.message)||t.message;k((0,f.dX)(e))}finally{D(!1)}};return(0,n.jsxs)("div",{children:[(0,n.jsx)(o.Z,{children:(0,n.jsx)(c.Z,{span:24,children:(0,n.jsxs)("div",{className:"centered standard-margin",children:[(0,n.jsx)(g.Z,{src:"logo.png",alt:"Distributed Crypto Logo",width:180,height:37}),(0,n.jsx)("h3",{children:"Create new data listing"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{})]})})}),(0,n.jsxs)(o.Z,{children:[(0,n.jsx)(c.Z,{span:16,children:(0,n.jsxs)("div",{className:"create-form white boxed",children:[!N&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h3",{className:"vertical-margin",children:"General Information:"}),(0,n.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),S()},children:"Set demo values"}),(0,n.jsx)(u.Z,{}),(0,n.jsx)("h4",{children:"Name"}),(0,n.jsx)(l.Z,{placeholder:"Name of listing",value:j.name,onChange:e=>L("name",e.target.value)}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)("h4",{children:"Description"}),(0,n.jsx)(m.default,{"aria-label":"Description",onChange:e=>L("description",e.target.value),placeholder:"Add any additional description on the dataset",prefix:"Description",value:j.description}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsxs)("h4",{children:["Price (",v.hs.symbol,")"]}),(0,n.jsx)(l.Z,{placeholder:"Purchase price",value:j.price,onChange:e=>L("price",e.target.value)}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)("h4",{children:"[Optional] Listing image (link)"}),(0,n.jsx)(l.Z,{placeholder:"Provide a link to an image describing your listing",value:j.image,onChange:e=>L("image",e.target.value)}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)("h4",{children:"[Optional] Keywords (enter separated by comma)"}),(0,n.jsx)(l.Z,{placeholder:"Add keywords to help others understand and find your listing",value:j.keywords,onChange:e=>L("keywords",e.target.value)}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)("h4",{children:"Address"}),(0,n.jsx)(l.Z,{placeholder:"Your address",value:(null==r?void 0:r.address)||j.createdby,disabled:!0,onChange:e=>L("createdBy",e.target.value)}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)("h4",{children:"Is this a large dataset (over 5MB) or do you have a CID already?"}),(0,n.jsx)(x.Z,{type:"checkbox",checked:j.useCid,onChange:e=>L("useCid",e.target.checked)}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),j.useCid&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(p.Z,{title:"Provide CID link to dataset",children:[(0,n.jsx)("br",{}),(0,n.jsxs)("p",{children:["Use an existing dataset cid or a ",(0,n.jsx)("a",{href:"https://lotus.filecoin.io/tutorials/lotus/large-files/",target:"_blank",children:"Lotus"})," client to upload an encrypted or unencrypted (less secure) dataset."]}),(0,n.jsx)("br",{}),(0,n.jsx)("h4",{children:"Dataset CID"}),(0,n.jsx)(l.Z,{placeholder:"Dataset CID",value:j.cid,onChange:e=>L("cid",e.target.value)})]})}),!j.useCid&&(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(p.Z,{title:"Upload dataset(s) for purchaseable collection",children:(0,n.jsx)(M,{files:j.files||[],setFiles:e=>L("files",e)})})}),(0,n.jsxs)("div",{children:[(0,n.jsx)(s(),{type:"primary",className:"standard-button",onClick:_,disabled:C||T,loading:C,size:"large",children:"Create Listing"}),!w&&!N&&C&&(0,n.jsx)("span",{className:"italic",children:"\xa0Deploying a listing contract. Confirmation may take a few moments."}),(0,n.jsx)(u.Z,{}),(0,n.jsxs)("p",{className:"bold",children:["Note: Listings are considered unverified until confirmed by an admin of ",v.iC," after posting."]})]}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{})]}),w&&(0,n.jsxs)("div",{className:"error-text",children:["Error: ",w]}),N&&(0,n.jsxs)("div",{children:[(0,n.jsx)(h.ZP,{status:"success",title:"Listing created! Confirm last transaction to index the result",subTitle:"Access your data page and content below. It may take a few minutes to confirm the listing on the network."}),(0,n.jsxs)("div",{children:[(0,n.jsx)(s(),{href:(0,f.W)(N.cid),target:"_blank",children:"Download files"}),(0,n.jsx)("br",{}),(0,n.jsx)("a",{href:N.contractUrl,target:"_blank",children:"View created contract"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsxs)("p",{children:["Share or post this page with potential buyers:",(0,n.jsx)("br",{}),(0,n.jsx)("a",{href:N.listingUrl,target:"_blank",children:"View listing page"})," (the listing may take a few minutes to become available on the network)."]})]})]})]})}),(0,n.jsx)(c.Z,{span:1}),(0,n.jsx)(c.Z,{span:7,children:(0,n.jsx)("div",{className:"white boxed",children:(0,n.jsx)(d.default,{className:"standard-margin",direction:"vertical",size:"small",items:[{title:"Fill in fields",description:"Enter required data."},{title:"Create ".concat(v.iC," listing"),description:"Deploys a smart contract and creates a purchase page for the dataset"},{title:"Use the generated purchase page to sell your data"}],current:N?2:T?0:1})})})]})]})}S.propTypes={};var L=S},67245:function(e,t,r){"use strict";r.r(t),r.d(t,{WalletContext:function(){return s},WalletProviderWrapper:function(){return l},useWallet:function(){return o}});var n=r(57437),a=r(2265),i=r(93697);let s=(0,a.createContext)({}),l=e=>{let{children:t}=e,[r,l]=(0,a.useState)(null),[o,c]=(0,a.useState)(null),[d,h]=(0,a.useState)(null),u=async()=>{let e=new i.ig,t=await e.connectWallet({wallet:i.Ag.METAMASK});l(t),c(e),h(await e.getProvider())},x=async()=>{try{await o.disconnectWallet()}catch(e){console.error("error logging out",e)}l(null)};return(0,n.jsx)(s.Provider,{value:{wallet:r,connect:u,logout:x,provider:d,dataverseConnector:o,test:5},children:t})},o=()=>(0,a.useContext)(s)},61927:function(e,t,r){"use strict";r.d(t,{$A:function(){return i},JI:function(){return f},RD:function(){return g},W:function(){return c},dX:function(){return p},g$:function(){return l},iN:function(){return h},jY:function(){return u},sN:function(){return d},xG:function(){return o},xb:function(){return x}});var n=r(86260),a=r(73760);let i=e=>e?"".concat(e.substr(0,6),"**"):"",s=e=>(e instanceof Date||(e=e?new Date(e):new Date),"".concat(e.toLocaleDateString()," ").concat(e.toLocaleTimeString())),l=e=>n.O0===e,o=(e,t)=>0===e?"Free":e?"".concat(e," ").concat(t||n.hs.symbol):"",c=(e,t)=>{let r="".concat(n._W,"/").concat(e);return t?"".concat(r,"/").concat(t):r},d=e=>"".concat(window.location.origin,"/listing/").concat(e),h=e=>13===e.length?new Date(e).toLocaleDateString():e.replace(/([A-Z])/g," $1").replace(/^./,function(e){return e.toUpperCase()}).replace(/_/g," "),u=(e,t)=>"".concat(n.hs.explorerUrl).concat(t?"tx/":"address/").concat(e).concat(31415===n.hs.id?"?network=wallaby":""),x=e=>!e||0===e.length,p=e=>(-1!==e.indexOf("404")?e="Dataset not found. Do you have the correct url? Otherwise, try creating a new dataset.":-1!==e.indexOf("network changed")&&(e="Network changed since page loaded, please refresh."),e);function g(e){if(0==e)return"0 Byte";var t=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,t),2)+" "+["Bytes","KB","MB","GB","TB"][t]}let f=e=>e?{...e,created_by:i(e.created_by),created_at:s(e.created_at),price:o(a.dF(e.price+""),n.hs.symbol),verified:e.verified?"Verified":"Unverified"}:{}}},function(e){e.O(0,[941,592,26,691,409,44,891,110,697,664,170,574,813,132,611,157,22,971,596,744],function(){return e(e.s=31119)}),_N_E=e.O()}]);